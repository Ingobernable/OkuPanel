{"version":3,"sources":["timeline-chart.js"],"names":["TimelineChart","element","data","opts","self","classList","add","options","extendOptions","allElements","reduce","agg","e","concat","minDt","d3","min","getPointMinDt","maxDt","max","getPointMaxDt","elementWidth","width","clientWidth","elementHeight","height","clientHeight","margin","top","right","bottom","left","groupWidth","hideGroupLabels","x","time","scale","domain","range","xAxis","svg","axis","orient","tickSize","zoom","behavior","on","zoomed","select","append","attr","call","enableLiveTimer","now","groupHeight","length","groupSection","selectAll","enter","d","i","groupLabels","text","label","lineSection","groupIntervalItems","filter","_","type","TYPE","INTERVAL","intervalBarHeight","intervalBarMargin","intervals","withCustom","Math","intervalMinWidth","to","from","intervalTexts","groupDotItems","POINT","dots","at","tip","html","show","hide","console","error","setInterval","updateNowMarker","timerTickInterval","nowX","Date","defaultClass","customClass","join","onVizChangeFn","event","translate","positionData","getTextPositionData","upToPosition","textWidth","xPosition","percent","textTruncateThreshold","substr","floor","textSizeInPx","getComputedTextLength","ext","defaultOptions","undefined","Object","keys","map","k","p","fn","Symbol","module","exports"],"mappings":"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","file":"timeline-chart.js","sourcesContent":["class TimelineChart {\n    constructor(element, data, opts) {\n        let self = this;\n\n        element.classList.add('timeline-chart');\n\n        let options = this.extendOptions(opts);\n\n        let allElements = data.reduce((agg, e) => agg.concat(e.data), []);\n\n        let minDt = d3.min(allElements, this.getPointMinDt);\n        let maxDt = d3.max(allElements, this.getPointMaxDt);\n\n        let elementWidth = options.width || element.clientWidth;\n        let elementHeight = options.height || element.clientHeight;\n\n        let margin = {\n            top: 0,\n            right: 0,\n            bottom: 20,\n            left: 0\n        };\n\n        let width = elementWidth - margin.left - margin.right;\n        let height = elementHeight - margin.top - margin.bottom;\n\n        let groupWidth = (options.hideGroupLabels)? 0: 200;\n\n        let x = d3.time.scale()\n            .domain([minDt, maxDt])\n            .range([groupWidth, width]);\n\n        let xAxis = d3.svg.axis()\n            .scale(x)\n            .orient('bottom')\n            .tickSize(-height);\n\n        let zoom = d3.behavior.zoom()\n            .x(x)\n            .on('zoom', zoomed);\n\n        let svg = d3.select(element).append('svg')\n            .attr('width', width + margin.left + margin.right)\n            .attr('height', height + margin.top + margin.bottom)\n            .append('g')\n            .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')')\n            .call(zoom);\n\n        svg.append('defs')\n            .append('clipPath')\n            .attr('id', 'chart-content')\n            .append('rect')\n            .attr('x', groupWidth)\n            .attr('y', 0)\n            .attr('height', height)\n            .attr('width', width - groupWidth)\n\n        svg.append('rect')\n            .attr('class', 'chart-bounds')\n            .attr('x', groupWidth)\n            .attr('y', 0)\n            .attr('height', height)\n            .attr('width', width - groupWidth)\n\n        svg.append('g')\n            .attr('class', 'x axis')\n            .attr('transform', 'translate(0,' + height + ')')\n            .call(xAxis);\n\n        if (options.enableLiveTimer) {\n            self.now = svg.append('line')\n                .attr('clip-path', 'url(#chart-content)')\n                .attr('class', 'vertical-marker now')\n                .attr(\"y1\", 0)\n                .attr(\"y2\", height);\n        }\n\n        let groupHeight = height / data.length;\n        let groupSection = svg.selectAll('.group-section')\n            .data(data)\n            .enter()\n            .append('line')\n            .attr('class', 'group-section')\n            .attr('x1', 0)\n            .attr('x2', width)\n            .attr('y1', (d, i) => {\n                return groupHeight * (i + 1);\n            })\n            .attr('y2', (d, i) => {\n                return groupHeight * (i + 1);\n            });\n\n        if (!options.hideGroupLabels) {\n            let groupLabels = svg.selectAll('.group-label')\n                .data(data)\n                .enter()\n                .append('text')\n                .attr('class', 'group-label')\n                .attr('x', 0)\n                .attr('y', (d, i) => {\n                    return (groupHeight * i) + (groupHeight / 2) + 5.5;\n                })\n                .attr('dx', '0.5em')\n                .text(d => d.label);\n\n            let lineSection = svg.append('line').attr('x1', groupWidth).attr('x2', groupWidth).attr('y1', 0).attr('y2', height).attr('stroke', 'black');\n        }\n\n        let groupIntervalItems = svg.selectAll('.group-interval-item')\n            .data(data)\n            .enter()\n            .append('g')\n            .attr('clip-path', 'url(#chart-content)')\n            .attr('class', 'item')\n            .attr('transform', (d, i) => `translate(0, ${groupHeight * i})`)\n            .selectAll('.dot')\n            .data(d => d.data.filter(_ => _.type === TimelineChart.TYPE.INTERVAL))\n            .enter();\n\n        let intervalBarHeight = 0.8 * groupHeight;\n        let intervalBarMargin = (groupHeight - intervalBarHeight) / 2;\n        let intervals = groupIntervalItems\n            .append('rect')\n            .attr('class', withCustom('interval'))\n            .attr('width', (d) => Math.max(options.intervalMinWidth, x(d.to) - x(d.from)))\n            .attr('height', intervalBarHeight)\n            .attr('y', intervalBarMargin)\n            .attr('x', (d) => x(d.from));\n\n        let intervalTexts = groupIntervalItems\n            .append('text')\n            .text(d => d.label)\n            .attr('fill', 'white')\n            .attr('class', withCustom('interval-text'))\n            .attr('y', (groupHeight / 2) + 5)\n            .attr('x', (d) => x(d.from));\n\n        let groupDotItems = svg.selectAll('.group-dot-item')\n            .data(data)\n            .enter()\n            .append('g')\n            .attr('clip-path', 'url(#chart-content)')\n            .attr('class', 'item')\n            .attr('transform', (d, i) => `translate(0, ${groupHeight * i})`)\n            .selectAll('.dot')\n            .data(d => {\n                return d.data.filter(_ => _.type === TimelineChart.TYPE.POINT);\n            })\n            .enter();\n\n        let dots = groupDotItems\n            .append('circle')\n            .attr('class', withCustom('dot'))\n            .attr('cx', d => x(d.at))\n            .attr('cy', groupHeight / 2)\n            .attr('r', 5);\n\n        if (options.tip) {\n            if (d3.tip) {\n                let tip = d3.tip().attr('class', 'd3-tip').html(options.tip);\n                svg.call(tip);\n                dots.on('mouseover', tip.show).on('mouseout', tip.hide)\n            } else {\n                console.error('Please make sure you have d3.tip included as dependency (https://github.com/Caged/d3-tip)');\n            }\n        }\n\n        zoomed();\n\n        if (options.enableLiveTimer) {\n            setInterval(updateNowMarker, options.timerTickInterval);\n        }\n\n        function updateNowMarker() {\n            let nowX = x(new Date());\n\n            self.now.attr('x1', nowX).attr('x2', nowX);\n        }\n\n        function withCustom(defaultClass) {\n            return d => d.customClass ? [d.customClass, defaultClass].join(' ') : defaultClass\n        }\n\n        function zoomed() {\n            if (self.onVizChangeFn && d3.event) {\n                self.onVizChangeFn.call(self, {\n                    scale: d3.event.scale,\n                    translate: d3.event.translate,\n                    domain: x.domain()\n                });\n            }\n\n            if (options.enableLiveTimer) {\n                updateNowMarker();\n            }\n\n            svg.select('.x.axis').call(xAxis);\n\n            svg.selectAll('circle.dot').attr('cx', d => x(d.at));\n            svg.selectAll('rect.interval').attr('x', d => x(d.from)).attr('width', d => Math.max(options.intervalMinWidth, x(d.to) - x(d.from)));\n\n            svg.selectAll('.interval-text').attr('x', function(d) {\n                    let positionData = getTextPositionData.call(this, d);\n                    if ((positionData.upToPosition - groupWidth - 10) < positionData.textWidth) {\n                        return positionData.upToPosition;\n                    } else if (positionData.xPosition < groupWidth && positionData.upToPosition > groupWidth) {\n                        return groupWidth;\n                    }\n                    return positionData.xPosition;\n                }).attr('text-anchor', function(d) {\n                    let positionData = getTextPositionData.call(this, d);\n                    if ((positionData.upToPosition - groupWidth - 10) < positionData.textWidth) {\n                        return 'end';\n                    }\n                    return 'start';\n                })\n                .attr('dx', function(d) {\n                    let positionData = getTextPositionData.call(this, d);\n                    if ((positionData.upToPosition - groupWidth - 10) < positionData.textWidth) {\n                        return '-0.5em';\n                    }\n                    return '0.5em';\n                }).text(function(d) {\n                    var positionData = getTextPositionData.call(this, d);\n                    var percent = (positionData.width - options.textTruncateThreshold) / positionData.textWidth;\n                    if (percent < 1) {\n                        if (positionData.width > options.textTruncateThreshold) {\n                            return d.label.substr(0, Math.floor(d.label.length * percent)) + '...';\n                        } else {\n                            return '';\n                        }\n                    }\n\n                    return d.label;\n                });\n\n            function getTextPositionData(d) {\n                this.textSizeInPx = this.textSizeInPx || this.getComputedTextLength();\n                var from = x(d.from);\n                var to = x(d.to);\n                return {\n                    xPosition: from,\n                    upToPosition: to,\n                    width: to - from,\n                    textWidth: this.textSizeInPx\n                }\n            }\n        }\n    }\n    extendOptions(ext = {}) {\n        let defaultOptions = {\n            intervalMinWidth: 8, // px\n            tip: undefined,\n            textTruncateThreshold: 30,\n            enableLiveTimer: false,\n            timerTickInterval: 1000,\n            hideGroupLabels: false\n        };\n        Object.keys(ext).map(k => defaultOptions[k] = ext[k]);\n        return defaultOptions;\n    }\n    getPointMinDt(p) {\n        return p.type === TimelineChart.TYPE.POINT ? p.at : p.from;\n    }\n    getPointMaxDt(p) {\n        return p.type === TimelineChart.TYPE.POINT ? p.at : p.to;\n    }\n    onVizChange(fn) {\n        this.onVizChangeFn = fn;\n        return this;\n    }\n}\n\nTimelineChart.TYPE = {\n    POINT: Symbol(),\n    INTERVAL: Symbol()\n};\n\nmodule.exports = TimelineChart;\n"]}